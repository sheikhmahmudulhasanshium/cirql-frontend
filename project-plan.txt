Change Log & Project Status: Social and Profile Feature Implementation
System Overview
Goal: To build an intelligent and robust social networking system within your existing application, covering user profiles, friendships, followers, recommendations, and notifications.
Architecture: The system uses a Backend-for-Frontend (BFF) pattern. The NestJS backend handles all business logic and data aggregation, providing clean, ready-to-use data to the Next.js frontend. The frontend is responsible for displaying this data and handling user interactions.
What We've Done (Completed Tasks)
1. Intelligent Profile Buttons & Social Counts:
The backend's /profile/:userId endpoint now calculates and returns the precise friendshipStatus and followStatus between the viewing user and the profile owner, offloading all complex logic from the client.
The frontend menu-bar.tsx component was refactored to simply display buttons based on the status provided by the backend.
Profile pages now display clickable social stats (Friends, Followers, Following) that link to the social hub.
2. Actionable Notifications:
The backend's social services now ensure that all social notifications include a direct, clickable linkUrl that takes the user to the most relevant page (e.g., /social/friend-requests).
3. Multi-Page Social Hub:
Created a new, dedicated /social section with a shared layout and navigation (SocialNavbar).
Built separate, independent pages for Friends, Followers, Friend Requests (Received), and Sent Friend Requests.
4. Social Recommendations Feature (NEWLY COMPLETED):
Backend:
Implemented a robust recommendation engine in recommendations.service.ts that suggests users based on shared interests.
The engine correctly filters out the current user, existing friends, followers, and followed users.
It prioritizes results by the number of common interests, with follower count as a tie-breaker.
Exposed the logic via a secure, paginated endpoint at GET /social/recommendations/users.
Frontend:
Created a dedicated /interests page for users to select 5-10 topics, which are saved to their user settings.
Made the interests editable directly from the /profile/me page via a modal for a seamless UX.
Built a new /social/recommendations page that displays suggested users in a responsive grid.
Created a reusable UserRecommendationCard component with clear actions ("Add Friend", "Follow", "Dismiss") and user feedback.
Integrated a horizontal list of recommendations onto the main dashboard (/home) to drive engagement.
5. Enhanced User Experience & Bug Fixes:
A reusable ConfirmationModal was created for destructive actions.
Implemented professional skeleton loaders to prevent layout shifts.
Resolved bugs related to data fetching and population in the social hub.
Cleaned up API client error logging.
To-Do List (Next Steps)
Implement "Following" List Page:
Create a backend endpoint and service function to get the list of users someone is following.
Build the corresponding frontend page at /social/following-list.
Implement Clipboard for 2FA Code:
Backend: Add a div with a specific ID to the 2FA email template.
Frontend: Create the ClipboardButton component and integrate it into the 2FA login page.
Refine Social Actions on Recommendation Cards:
Connect the "Add Friend" and "Follow" buttons on the UserRecommendationCard to their respective API hooks (use-profile-actions.ts).
Revisit the Upload System (Future):
As noted, the current upload system is a pain point. A future task will be to follow a clear, structured plan to rebuild it from the ground up using best practices for a separated frontend/backend architecture.
Affected Files (Updated)
Backend (NestJS)
src/social/friends.service.ts: MODIFIED
src/social/followers.service.ts: MODIFIED
src/profile/profile.service.ts: MODIFIED
src/profile/dto/profile.response.dto.ts: MODIFIED
src/settings/schemas/setting.schema.ts: MODIFIED (Interests array added to ContentPreferences).
src/social/social.module.ts: MODIFIED (Added RecommendationsService and Setting schema).
src/social/recommendations.service.ts: CREATED
src/social/recommendations.controller.ts: CREATED
Frontend (Next.js)
app/(routes)/profile/[id]/body.tsx: MODIFIED
app/(routes)/profile/me/body.tsx: MODIFIED (Added editable interests section).
app/(routes)/profile/menu-bar.tsx: MODIFIED
app/(routes)/social/layout.tsx: CREATED
app/(routes)/social/friends-list/*: CREATED
app/(routes)/social/followers-list/*: CREATED
app/(routes)/social/friend-requests/*: CREATED
app/(routes)/social/sent-requests/*: CREATED
app/(routes)/interests/page.tsx & body.tsx: CREATED (New page for interest selection).
app/(routes)/social/recommendations/page.tsx & body.tsx & list.tsx: CREATED (New page and components).
app/(routes)/home/UserDashboard.tsx: MODIFIED (Integrated recommendations widget).
components/hooks/social/use-friends-list.ts: CREATED
components/hooks/social/use-followers-list.ts: CREATED
components/hooks/social/use-recommendations.ts: CREATED
components/social/*: CREATED/MODIFIED (Various list and card components).
components/modals/confirmation-modal.tsx: CREATED
components/modals/profile/interests-modal.tsx: CREATED
lib/types.ts: MODIFIED (Updated Profile, SocialProfile interfaces).
lib/apiClient.ts: MODIFIED
lib/menu.tsx: MODIFIED (Added InterestsList and navbar links).